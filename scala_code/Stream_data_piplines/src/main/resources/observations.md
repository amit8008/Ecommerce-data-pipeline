# Tumbling Window V/S Sliding Window
```
-------------------------------------------
Batch: 0
-------------------------------------------
+------------------------------------------+----+-----+
|window                                    |User|count|
+------------------------------------------+----+-----+
|{2015-02-23 15:40:00, 2015-02-23 15:50:00}|g   |121  |
|{2015-02-23 15:50:00, 2015-02-23 16:00:00}|g   |1165 |
|{2015-02-23 16:00:00, 2015-02-23 16:10:00}|g   |1267 |
|{2015-02-23 16:10:00, 2015-02-23 16:20:00}|g   |1121 |
|{2015-02-23 16:20:00, 2015-02-23 16:30:00}|g   |2119 |
|{2015-02-23 16:30:00, 2015-02-23 16:40:00}|g   |1342 |
|{2015-02-23 16:40:00, 2015-02-23 16:50:00}|g   |1136 |
|{2015-02-23 16:50:00, 2015-02-23 17:00:00}|g   |896  |
+------------------------------------------+----+-----+

-------------------------------------------
Batch: 1
-------------------------------------------
+------------------------------------------+----+-----+
|window                                    |User|count|
+------------------------------------------+----+-----+
|{2015-02-23 15:40:00, 2015-02-23 15:50:00}|g   |294  |
|{2015-02-23 15:50:00, 2015-02-23 16:00:00}|g   |2458 |
|{2015-02-23 16:00:00, 2015-02-23 16:10:00}|g   |2518 |
|{2015-02-23 16:10:00, 2015-02-23 16:20:00}|g   |2240 |
|{2015-02-23 16:20:00, 2015-02-23 16:30:00}|g   |4049 |
|{2015-02-23 16:30:00, 2015-02-23 16:40:00}|g   |2647 |
|{2015-02-23 16:40:00, 2015-02-23 16:50:00}|g   |2263 |
|{2015-02-23 16:50:00, 2015-02-23 17:00:00}|g   |1866 |
+------------------------------------------+----+-----+
-------------------------------------------
Batch: 0
-------------------------------------------
+------------------------------------------+----+-----+
|window                                    |User|count|
+------------------------------------------+----+-----+
|{2015-02-23 15:40:00, 2015-02-23 15:50:00}|g   |121  |
|{2015-02-23 15:45:00, 2015-02-23 15:55:00}|g   |656  |
|{2015-02-23 15:50:00, 2015-02-23 16:00:00}|g   |1165 |
|{2015-02-23 15:55:00, 2015-02-23 16:05:00}|g   |1218 |
|{2015-02-23 16:00:00, 2015-02-23 16:10:00}|g   |1267 |
|{2015-02-23 16:05:00, 2015-02-23 16:15:00}|g   |1250 |
|{2015-02-23 16:10:00, 2015-02-23 16:20:00}|g   |1121 |
|{2015-02-23 16:15:00, 2015-02-23 16:25:00}|g   |1729 |
|{2015-02-23 16:20:00, 2015-02-23 16:30:00}|g   |2119 |
|{2015-02-23 16:25:00, 2015-02-23 16:35:00}|g   |1567 |
|{2015-02-23 16:30:00, 2015-02-23 16:40:00}|g   |1342 |
|{2015-02-23 16:35:00, 2015-02-23 16:45:00}|g   |1259 |
|{2015-02-23 16:40:00, 2015-02-23 16:50:00}|g   |1136 |
|{2015-02-23 16:45:00, 2015-02-23 16:55:00}|g   |1147 |
|{2015-02-23 16:50:00, 2015-02-23 17:00:00}|g   |896  |
|{2015-02-23 16:55:00, 2015-02-23 17:05:00}|g   |341  |
+------------------------------------------+----+-----+

-------------------------------------------
Batch: 1
-------------------------------------------
+------------------------------------------+----+-----+
|window                                    |User|count|
+------------------------------------------+----+-----+
|{2015-02-23 15:40:00, 2015-02-23 15:50:00}|g   |294  |
|{2015-02-23 15:45:00, 2015-02-23 15:55:00}|g   |1367 |
|{2015-02-23 15:50:00, 2015-02-23 16:00:00}|g   |2458 |
|{2015-02-23 15:55:00, 2015-02-23 16:05:00}|g   |2538 |
|{2015-02-23 16:00:00, 2015-02-23 16:10:00}|g   |2518 |
|{2015-02-23 16:05:00, 2015-02-23 16:15:00}|g   |2493 |
|{2015-02-23 16:10:00, 2015-02-23 16:20:00}|g   |2240 |
|{2015-02-23 16:15:00, 2015-02-23 16:25:00}|g   |3369 |
|{2015-02-23 16:20:00, 2015-02-23 16:30:00}|g   |4049 |
|{2015-02-23 16:25:00, 2015-02-23 16:35:00}|g   |3001 |
|{2015-02-23 16:30:00, 2015-02-23 16:40:00}|g   |2647 |
|{2015-02-23 16:35:00, 2015-02-23 16:45:00}|g   |2529 |
|{2015-02-23 16:40:00, 2015-02-23 16:50:00}|g   |2263 |
|{2015-02-23 16:45:00, 2015-02-23 16:55:00}|g   |2306 |
|{2015-02-23 16:50:00, 2015-02-23 17:00:00}|g   |1866 |
|{2015-02-23 16:55:00, 2015-02-23 17:05:00}|g   |732  |
+------------------------------------------+----+-----+

```


## With or without withWatermark 


### without withWatermark
```
without watermark

24/12/19 23:55:39 WARN ResolveWriteToStream: Temporary checkpoint location created which is deleted normally when the query didn't fail: C:\Users\amit8\AppData\Local\Temp\temporary-af4de2ae-306b-4cee-9e62-94cdb6fbfeb0. If it's required to delete it under any circumstances, please set spark.sql.streaming.forceDeleteTempCheckpointLocation to true. Important to know deleting temp checkpoint folder is best effort.
24/12/19 23:55:39 WARN ResolveWriteToStream: spark.sql.adaptive.enabled is not supported in streaming DataFrames/Datasets and will be disabled.
-------------------------------------------
Batch: 0
-------------------------------------------
+------------------------------------------+----+-----+
|window                                    |User|count|
+------------------------------------------+----+-----+
|{2015-02-23 15:40:00, 2015-02-23 15:50:00}|g   |121  |
|{2015-02-23 15:45:00, 2015-02-23 15:55:00}|g   |656  |
|{2015-02-23 15:50:00, 2015-02-23 16:00:00}|g   |1165 |
|{2015-02-23 15:55:00, 2015-02-23 16:05:00}|g   |1218 |
|{2015-02-23 16:00:00, 2015-02-23 16:10:00}|g   |1267 |

```

### with withWatermark

```

Exception in thread "main" org.apache.spark.sql.AnalysisException: checkpointLocation must be specified either through option("checkpointLocation", ...) or SparkSession.conf.set("spark.sql.streaming.checkpointLocation", ...).
	at org.apache.spark.sql.errors.QueryCompilationErrors$.checkpointLocationNotSpecifiedError(QueryCompilationErrors.scala:2992)
	at org.apache.spark.sql.execution.streaming.ResolveWriteToStream$.$anonfun$resolveCheckpointLocation$5(ResolveWriteToStream.scala:95)

```
**To resolve this add checkpoint location**
.config("spark.sql.streaming.checkpointLocation","C:\\Users\\amit8\\AppData\\Local\\Temp")
```
-------------------------------------------
Batch: 0
-------------------------------------------
+------------------------------------------+----+-----+
|window                                    |User|count|
+------------------------------------------+----+-----+
|{2015-02-23 15:40:00, 2015-02-23 15:50:00}|g   |121  |
|{2015-02-23 15:45:00, 2015-02-23 15:55:00}|g   |656  |
|{2015-02-23 15:50:00, 2015-02-23 16:00:00}|g   |1165 |
|{2015-02-23 15:55:00, 2015-02-23 16:05:00}|g   |1218 |
|{2015-02-23 16:00:00, 2015-02-23 16:10:00}|g   |1267 |
|{2015-02-23 16:05:00, 2015-02-23 16:15:00}|g   |1250 |
|{2015-02-23 16:10:00, 2015-02-23 16:20:00}|g   |1121 |
|{2015-02-23 16:15:00, 2015-02-23 16:25:00}|g   |1729 |
|{2015-02-23 16:20:00, 2015-02-23 16:30:00}|g   |2119 |
|{2015-02-23 16:25:00, 2015-02-23 16:35:00}|g   |1567 |
|{2015-02-23 16:30:00, 2015-02-23 16:40:00}|g   |1342 |
|{2015-02-23 16:35:00, 2015-02-23 16:45:00}|g   |1259 |
|{2015-02-23 16:40:00, 2015-02-23 16:50:00}|g   |1136 |
|{2015-02-23 16:45:00, 2015-02-23 16:55:00}|g   |1147 |
|{2015-02-23 16:50:00, 2015-02-23 17:00:00}|g   |896  |
|{2015-02-23 16:55:00, 2015-02-23 17:05:00}|g   |341  |
+------------------------------------------+----+-----+

-------------------------------------------
Batch: 1
-------------------------------------------
+------------------------------------------+----+-----+
|window                                    |User|count|
+------------------------------------------+----+-----+
|{2015-02-23 15:40:00, 2015-02-23 15:50:00}|g   |294  |
|{2015-02-23 15:45:00, 2015-02-23 15:55:00}|g   |1367 |
|{2015-02-23 15:50:00, 2015-02-23 16:00:00}|g   |2458 |
|{2015-02-23 15:55:00, 2015-02-23 16:05:00}|g   |2538 |
|{2015-02-23 16:00:00, 2015-02-23 16:10:00}|g   |2518 |
|{2015-02-23 16:05:00, 2015-02-23 16:15:00}|g   |2493 |
|{2015-02-23 16:10:00, 2015-02-23 16:20:00}|g   |2240 |
|{2015-02-23 16:15:00, 2015-02-23 16:25:00}|g   |3369 |
|{2015-02-23 16:20:00, 2015-02-23 16:30:00}|g   |4049 |
|{2015-02-23 16:25:00, 2015-02-23 16:35:00}|g   |3001 |
|{2015-02-23 16:30:00, 2015-02-23 16:40:00}|g   |2647 |
|{2015-02-23 16:35:00, 2015-02-23 16:45:00}|g   |2529 |
|{2015-02-23 16:40:00, 2015-02-23 16:50:00}|g   |2263 |
|{2015-02-23 16:45:00, 2015-02-23 16:55:00}|g   |2306 |
|{2015-02-23 16:50:00, 2015-02-23 17:00:00}|g   |1866 |
|{2015-02-23 16:55:00, 2015-02-23 17:05:00}|g   |732  |
+------------------------------------------+----+-----+

```
## with or withour dropDuplicate

### with dropDuplicate

```
-------------------------------------------
Batch: 0
-------------------------------------------
+----+-----+
|User|count|
+----+-----+
|g   |9167 |
+----+-----+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+-----+
|User|count|
+----+-----+
|g   |18335|
+----+-----+
```

